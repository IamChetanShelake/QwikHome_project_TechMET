# API Authentication Documentation

## Authentication API Endpoints

This document describes the authentication API endpoints for user signup, login, and logout functionality.

### Base URL
```
http://your-domain.com/api
```

---

## Endpoints

### 1. User Signup
**POST** `/api/signup`

Register a new user account.

#### Request Body
```json
{
  "name": "John Doe",
  "email": "john.doe@example.com",
  "phone": "+1234567890",
  "password": "password123",
  "password_confirmation": "password123",
  "role": "customer"
}
```

#### Parameters
- `name` (required): User's full name
- `email` (required): Valid email address
- `phone` (required): Phone number (unique)
- `password` (required): Password (minimum 8 characters, must contain uppercase, lowercase, and numbers)
- `password_confirmation` (required): Password confirmation
- `role` (optional): User role - `customer`, `vendor`, or `admin` (defaults to `customer`)

#### Response Success (201)
```json
{
  "success": true,
  "status_code": 201,
  "message": "User registered successfully",
  "data": {
    "user": {
      "id": 1,
      "name": "John Doe",
      "email": "john.doe@example.com",
      "phone": "+1234567890",
      "role": "customer",
      "active": 1,
      "created_at": "2025-10-06T10:30:00.000000Z",
      "updated_at": "2025-10-06T10:30:00.000000Z"
    },
    "token": "1|abcdefghijk..."
  }
}
```

#### Response Validation Error (422)
```json
{
  "success": false,
  "status_code": 422,
  "message": "Validation failed",
  "errors": {
    "email": ["The email has already been taken."],
    "password": ["The password must be at least 8 characters."]
  }
}
```

---

### 2. User Login
**POST** `/api/login`

Authenticate user and get access token. Users can login using either email or phone number.

#### Request Body (Login with Email)
```json
{
  "email": "john.doe@example.com",
  "password": "password123"
}
```

#### Request Body (Login with Phone)
```json
{
  "phone": "+1234567890",
  "password": "password123"
}
```

#### Parameters
- `email` (optional): User's email address (required if phone not provided)
- `phone` (optional): User's phone number (required if email not provided)
- `password` (required): User's password

**Note:** You must provide either `email` OR `phone`, but not both.

#### Response Success (200)
```json
{
  "success": true,
  "status_code": 200,
  "message": "Login successful",
  "data": {
    "user": {
      "id": 1,
      "name": "John Doe",
      "email": "john.doe@example.com",
      "phone": "+1234567890",
      "role": "customer",
      "active": 1,
      "created_at": "2025-10-06T10:30:00.000000Z",
      "updated_at": "2025-10-06T10:30:00.000000Z"
    },
    "token": "1|abcdefghijk..."
  }
}
```

#### Response Validation Error (422)
```json
{
  "success": false,
  "status_code": 422,
  "message": "Validation failed",
  "errors": {
    "email": ["The email must be a valid email address."]
  }
}
```

#### Response Invalid Credentials (401)
```json
{
  "success": false,
  "status_code": 401,
  "message": "Invalid credentials"
}
```

#### Response Account Deactivated (403)
```json
{
  "success": false,
  "status_code": 403,
  "message": "Account is deactivated"
}
```

---

### 3. User Logout
**POST** `/api/logout`

Logout user by revoking access token.

#### Headers
```
Authorization: Bearer {token}
```

#### Response Success (200)
```json
{
  "success": true,
  "status_code": 200,
  "message": "Logout successful"
}
```

#### Response Error (500)
```json
{
  "success": false,
  "status_code": 500,
  "message": "Logout failed",
  "error": "Error message"
}
```

---

### 4. Get Authenticated User
**GET** `/api/user`

Get details of currently authenticated user.

#### Headers
```
Authorization: Bearer {token}
```

#### Response Success (200)
```json
{
  "id": 1,
  "name": "John Doe",
  "email": "john.doe@example.com",
  "phone": "+1234567890",
  "role": "customer",
  "active": 1,
  "created_at": "2025-10-06T10:30:00.000000Z",
  "updated_at": "2025-10-06T10:30:00.000000Z",
  "updated_at": "2025-10-06T10:30:00.000000Z"
}
```

---

## Authentication

### API Token Usage
Include the Bearer token in the Authorization header for protected routes:

```
Authorization: Bearer {token}
```

### Token Expiration
Tokens generated by Laravel Sanctum typically don't expire, but can be revoked using the logout endpoint.

---

## Error Codes

- `200`: Success
- `201`: Created (for signup)
- `401`: Unauthorized (invalid credentials)
- `403`: Forbidden (account deactivated)
- `422`: Validation failed
- `500`: Internal server error

---

## Testing Examples

### Signup Request
```bash
curl -X POST http://your-domain.com/api/signup \
  -H "Content-Type: application/json" \
  -d '{
    "name": "John Doe",
    "email": "john.doe@example.com",
    "phone": "+1234567890",
    "password": "password123",
    "password_confirmation": "password123",
    "role": "customer"
  }'
```

### Login Request (with Email)
```bash
curl -X POST http://your-domain.com/api/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "john.doe@example.com",
    "password": "password123"
  }'
```

### Login Request (with Phone)
```bash
curl -X POST http://your-domain.com/api/login \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "+1234567890",
    "password": "password123"
  }'
```

### Accessing Protected Route
```bash
curl -X GET http://your-domain.com/api/user \
  -H "Authorization: Bearer {token}"
```

### Logout Request
```bash
curl -X POST http://your-domain.com/api/logout \
  -H "Authorization: Bearer {token}"
